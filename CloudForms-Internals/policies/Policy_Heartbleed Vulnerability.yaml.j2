---
- MiqPolicy:
    name: bc031f1a-e249-11e3-9d65-005056b80000
    description: Heartbleed Vulnerability
    expression: !ruby/object:MiqExpression
      exp:
        INCLUDES:
          field: Vm-platform
          value: linux
      context_type:
    towhat: Vm
    guid: bc031f1a-e249-11e3-9d65-005056b80000
    created_by: admin
    updated_by: admin
    notes: |
      This are the openssl package versions affected by Heartbleed:
      openssl-1.0.1e-15.el6
      openssl-1.0.1e-16.el6_5.1
      openssl-1.0.1e-16.el6_5.4
      openssl-1.0.1e-16.el6_5

      Starting with openssl-1.0.1e-16.el6_5.7 hearbleed is fixed.
    active: true
    mode: compliance
    read_only:
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: log
        description: Generate log message
        guid: e800c9aa-d60f-11e3-85b2-001a4ab4f909
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 2
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: 339f0cc8-317e-11e3-88e1-005056b80000
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 3
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: d4ea28d8-f051-11e2-97c5-000c297e26aa
        description: Send Email to Security Team
        guid: d4ea28d8-f051-11e2-97c5-000c297e26aa
        action_type: email
        options:
          :from: cloudforms@{{ hailstorm_dns_domain }}
          :to: admin@{{ hailstorm_dns_domain }}
    - qualifier: failure
      failure_sequence: 4
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: evm_event
        description: Show EVM Event on Timeline
        guid: 50a4dd5a-30a7-11e5-95b5-005056bfd2a3
        action_type: default
        options: {}
    Condition:
    - name: 20a8dc70-e245-11e3-9d65-005056b80000
      description: Vulnerable OpenSSL Package (Heartbleed)
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              field: Vm.guest_applications-name
              value: openssl
          - not:
              FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 1.0.1e
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 1[56]\.(el6\b|el6_5(?!\.)|el6_5.1|el6_5.4)
        context_type:
      towhat: Vm
      file_mtime:
      guid: 20a8dc70-e245-11e3-9d65-005056b80000
      filename:
      applies_to_exp:
      miq_policy_id:
      notes:
      read_only:
